<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>holberton-smiling</title>
    <!-- Custom and Font Styles  -->
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="font-style.css" />
    <link rel="icon" href="images/favicon.ico" type="image/x-icon" />
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Coiny&display=swap" rel="stylesheet"/>
    <!-- Bootstrap -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" crossorigin="anonymous"/>
  </head>
  <body class="body">
    <header class="header courses-header">
      <div class="container">
        <nav class="navbar navbar-expand-sm navbar-dark pt-4 px-0">
          <button class="navbar-toggler border-0 align-self-start mt-3" type="button" data-toggle="collapse" data-target="#navbarNav">
            <span class="navbar-line1"></span>
            <span class="navbar-line2 my-1"></span>
            <span class="navbar-line3"></span>
          </button>
          <a class="navbar-brand mx-auto d-flex flex-column flex-sm-row align-items-center mt-3" href="homepage.html">
            <img src="images/smile_off.png" alt="navbar-logo" width="37px" class="mr-4 mb-3 mb-sm-0 mr-sm-3 img-fluid" />
            <img src="images/logo.png" alt="navbar-logo-text" width="114px" class="mr-4 img-fluid" />
          </a>
          <div class="collapse navbar-collapse text-center mt-3" id="navbarNav">
            <ul class="navbar-nav ml-auto font-weight-bold">
              <li class="nav-item"><a class="nav-link text-white px-1" href="courses.html">COURSES</a></li>
              <li class="nav-item px-0 px-sm-5 py-2 py-sm-0"><a class="nav-link text-white px-1" href="pricing.html">PRICING</a></li>
              <li class="nav-item"><a class="nav-link text-white px-1" href="#">LOGIN</a></li>
            </ul>
          </div>
        </nav>
        <section class="hero text-center text-white d-none d-sm-block">
          <h1 class="my-0">« Don’t cry because it’s over.<br /><span class="main-color">Smile</span> because it happened. »</h1>
        </section>
      </div>
    </header>

    <main>
      <!-- Search Section -->
      <section class="section search">
        <div class="container">
          <div class="row py-4">
            <div class="col-12 col-sm-12 col-lg-4 box1">
              <span class="text-white font-weight-bold drop-down-title">KEYWORDS</span>
              <div class="input-group mb-sm-4">
                <div class="input-group-prepend">
                  <span class="input-group-text holberton_school-icon-search_1"></span>
                </div>
                <input type="text" class="form-control search-text-area" placeholder="Search by keywords"/>
              </div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4 box2">
              <span class="text-white font-weight-bold drop-down-title">TOPIC</span>
              <div class="dropdown">
                <a class="btn dropdown-toggle text-left" href="#" role="button" data-toggle="dropdown">
                  <span>Novice</span>
                </a>
                <div class="dropdown-menu mt-0">
                  <a class="dropdown-item" href="#">Novice</a>
                  <a class="dropdown-item" href="#">Intermediate</a>
                  <a class="dropdown-item" href="#">Expert</a>
                </div>
              </div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4 box3">
              <span class="text-white font-weight-bold drop-down-title">SORT BY</span>
              <div class="dropdown">
                <a class="btn dropdown-toggle text-left" href="#" role="button" data-toggle="dropdown">
                  <span>Most Popular</span>
                </a>
                <div class="dropdown-menu mt-0">
                  <a class="dropdown-item" href="#">Most Popular</a>
                  <a class="dropdown-item" href="#">Most Recent</a>
                  <a class="dropdown-item" href="#">Most Viewed</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Results Section -->
      <section class="section results">
        <div class="container">
          <div class="section-title">
            <span class="text-muted video-count">0 videos</span>
          </div>
          <div class="row" id="courses-container">
            <!-- Dynamic video cards will appear here -->
          </div>
          <div id="loader" class="text-center my-4" style="display:none;">
            <img src="images/loader.gif" alt="Loading..." width="64px"/>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer d-flex align-items-center justify-content-center">
      <div class="container">
        <div class="row d-flex align-items-center flex-column flex-sm-row">
          <div class="col footer-item d-flex justify-content-center justify-content-sm-start">
            <div class="footer-logo">
              <img src="images/smile_off.png" alt="navbar-logo" width="37px" class="mr-4 mb-3 mb-sm-0 mr-sm-3 img-fluid"/>
              <img src="images/logo.png" alt="navbar-logo-text" width="114px" class="mr-4 img-fluid"/>
            </div>
          </div>
          <div class="col d-flex align-items-end align-self-sm-end justify-content-center order-2 order-sm-0 footer-item">
            <div class="trademark text-muted"><span>©smileschool 2020</span></div>
          </div>
          <div class="col d-flex align-items-center align-items-sm-end justify-content-center justify-content-sm-end footer-item">
            <div class="social">
              <ul class="social nav">
                <li class="social-item facebook-icon"><a href="https://www.facebook.com/HolbertonSchool/" class="social-link"><span class="holberton_school-icon-ic_facebook"></span></a></li>
                <li class="social-item twitter-icon"><a href="https://twitter.com/holbertonschool" class="social-link"><span class="holberton_school-icon-ic_twitter"></span></a></li>
                <li class="social-item instagram-icon"><a href="https://www.instagram.com/holbertonschool/" class="social-link"><span class="holberton_school-icon-ic_instagram"></span></a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Dynamic Courses Script -->
    <script>
      $(document).ready(function () {
        const $searchInput = $('.search-text-area');
        const $topicDropdown = $('.box2 .dropdown-menu');
        const $topicBtn = $('.box2 .dropdown-toggle span');
        const $sortDropdown = $('.box3 .dropdown-menu');
        const $sortBtn = $('.box3 .dropdown-toggle span');
        const $coursesContainer = $('#courses-container');
        const $videoCount = $('.video-count');
        const $loader = $('#loader');

        let searchQuery = '';
        let selectedTopic = '';
        let selectedSort = '';

        function fetchCourses() {
          $coursesContainer.empty();
          $loader.show();
          $.ajax({
            url: 'https://smileschool-api.hbtn.info/courses',
            method: 'GET',
            data: { q: searchQuery, topic: selectedTopic, sort: selectedSort },
            success: function(response) {
              $loader.hide();
              $videoCount.text(`${response.courses.length} videos`);
              response.courses.forEach(course => {
                const stars = Array(5).fill('<img src="images/star_off.png" width="15px"/>');
                for (let i = 0; i < Math.round(course.star); i++) stars[i] = '<img src="images/star_on.png" width="15px"/>';
                const cardHTML = `
                  <div class="col-12 col-sm-4 col-lg-3 d-flex justify-content-center mb-4">
                    <div class="card">
                      <img src="${course.thumb_url}" class="card-img-top" alt="Video thumbnail" />
                      <div class="card-img-overlay text-center">
                        <img src="images/play.png" alt="Play" width="64px" class="align-self-center play-overlay" />
                      </div>
                      <div class="card-body">
                        <h5 class="card-title font-weight-bold">${course.title}</h5>
                        <p class="card-text text-muted">${course.description}</p>
                        <div class="creator d-flex align-items-center">
                          <img src="${course.author_pic_url}" alt="${course.author}" width="30px" class="rounded-circle" />
                          <h6 class="pl-3 m-0 main-color">${course.author}</h6>
                        </div>
                        <div class="info pt-3 d-flex justify-content-between">
                          <div class="rating">${stars.join('')}</div>
                          <span class="main-color">${course.duration}</span>
                        </div>
                      </div>
                    </div>
                  </div>`;
                $coursesContainer.append(cardHTML);
              });
            },
            error: function() {
              $loader.hide();
              $coursesContainer.append('<p class="text-white">Failed to load courses.</p>');
            }
          });
        }

        // Initial fetch
        fetchCourses();

        // Event listeners
        $searchInput.on('input', function () {
          searchQuery = $(this).val();
          fetchCourses();
        });

        $topicDropdown.on('click', '.dropdown-item', function () {
          selectedTopic = $(this).text();
          $topicBtn.text(selectedTopic);
          fetchCourses();
        });

        $sortDropdown.on('click', '.dropdown-item', function () {
          selectedSort = $(this).text();
          $sortBtn.text(selectedSort);
          fetchCourses();
        });
      });
    </script>
  </body>
</html>
